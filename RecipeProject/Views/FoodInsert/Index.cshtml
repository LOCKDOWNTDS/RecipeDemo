@model FoodInsertVM
@{
    var Category = ViewBag.kategori as List<Category>;
}
<head>
    <meta charset="UTF-8">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.6.0.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.19.5/jquery.validate.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate.unobtrusive/3.2.11/jquery.validate.unobtrusive.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bootstrap 5 Image Upload Example</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .file-upload {
            border: 2px dashed #ddd;
            border-radius: 5px;
            text-align: center;
            padding: 50px;
            cursor: pointer;
            transition: border-color 0.3s;
        }

            .file-upload:hover {
                border-color: #007bff;
            }

        .file-upload-icon {
            font-size: 48px;
            color: #007bff;
        }

        .file-upload-text {
            margin-top: 10px;
            font-size: 16px;
            color: #6c757d;
        }

        .file-upload-input {
            display: none;
        }

        #Mainback {
            background-image: url('@Url.Content("~/img/SaveScreenOfFood.png")');
            width: 100%;
            height: 100%;
            background-size: cover;
            background-repeat: no-repeat;
        }
    </style>
</head>
<body id="Mainback">
    <div class="container-fluid" id="ContainerBackground">
        <form asp-action="SaveFood" asp-controller="FoodInsert" method="post" enctype="multipart/form-data" id="foodForm">
            <div class="row">
                <!-- Left Side -->
                <div class="col-md-6">
                    <div class="card mt-5">
                        <div class="card-header">Form</div>
                        <div class="card-body">
                            <div class="mb-3 row">
                                <label asp-for="Name" class="col-sm-4 col-form-label">Tarif Adı:</label>
                                <div class="col-sm-8">
                                    <input asp-for="Name" class="form-control" />
                                    <span asp-validation-for="Name" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="mb-3 row">
                                <label asp-for="Materials" class="col-sm-4 col-form-label">Malzemeler:</label>
                                <div class="col-sm-8">
                                    <textarea class="form-control" rows="3" asp-for="Materials"></textarea>
                                    <span asp-validation-for="Materials" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="mb-3 row">
                                <label asp-for="HowManyPerson" class="col-sm-4 col-form-label">Kaç Kişilik:</label>
                                <div class="col-sm-8">
                                    <select asp-for="HowManyPerson">
                                        <option value="" selected disabled></option>
                                        <option value="1 Kişilik">1 Kişilik</option>
                                        <option value="2 Kişilik">2 Kişilik</option>
                                        <option value="4 Kişilik">4 Kişilik</option>
                                        <option value="6 Kişilik">6 Kişilik</option>
                                        <option value="8 Kişilik">8 Kişilik</option>
                                        <option value="10 Kişilik">10 Kişilik</option>
                                        <option value="10+ Kişilik">10+ Kişilik</option>
                                    </select>
                                    <span asp-validation-for="HowManyPerson" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="mb-3 row">
                                <label asp-for="PreparationTime" class="col-sm-4 col-form-label">Hazırlama Süresi:</label>
                                <div class="col-sm-8">
                                    <select asp-for="PreparationTime">
                                        <option value="" selected disabled></option>
                                        <option value="10 Dakika">10 Dakika</option>
                                        <option value="20 Dakika">20 Dakika</option>
                                        <option value="30 Dakika">30 Dakika</option>
                                        <option value="40 Dakika">40 Dakika</option>
                                        <option value="50 Dakika">50 Dakika</option>
                                        <option value="60 Dakika">60 Dakika</option>
                                        <option value="60+ Dakika">60+ Dakika</option>
                                    </select>
                                    <span asp-validation-for="PreparationTime" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="mb-3 row">
                                <label asp-for="CookingTime" class="col-sm-4 col-form-label">Pişirme Süresi:</label>
                                <div class="col-sm-8">
                                    <select asp-for="CookingTime">
                                        <option value="" selected disabled></option>
                                        <option value="10 Dakika">10 Dakika</option>
                                        <option value="20 Dakika">20 Dakika</option>
                                        <option value="30 Dakika">30 Dakika</option>
                                        <option value="40 Dakika">40 Dakika</option>
                                        <option value="50 Dakika">50 Dakika</option>
                                        <option value="60 Dakika">60 Dakika</option>
                                        <option value="60+ Dakika">60+ Dakika</option>
                                    </select>
                                    <span asp-validation-for="CookingTime" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="mb-3 row">
                                <label asp-for="SelectedCategoryIds" class="col-sm-4 col-form-label">Kategoriler:</label>
                                <div class="col-sm-8">
                                    <select asp-for="SelectedCategoryIds" class="form-select" multiple="multiple">
                                        <option value="" selected disabled>Select...</option>
                                        @for (var i = 0; i < Category.Count; i++)
                                        {
                                            <option value="@Category[i].ID">@Category[i].CategoryName</option>
                                        }
                                    </select>
                                    <span asp-validation-for="SelectedCategoryIds" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="mb-3 row">
                                <label asp-for="RecipeExplanation" class="col-sm-4 col-form-label">Tarif Hazırlanışı:</label>
                                <div class="col-sm-8">
                                    <textarea class="form-control" rows="3" asp-for="RecipeExplanation"></textarea>
                                    <span asp-validation-for="RecipeExplanation" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="mb-3 row">
                                <label asp-for="OtherPictures" class="col-sm-4 col-form-label">Fotoğraf Ekle:</label>
                                <div class="col-sm-8">
                                    <input asp-for="OtherPictures" type="file" multiple class="form-control" accept="image/*" />
                                    <span asp-validation-for="OtherPictures" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="mb-3 row">
                                <div class="col-12 text-center">
                                    <button type="submit" class="btn btn-success" id="buttonsave" style="width:150px;">Kaydet</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Right Side -->
                <div class="col-md-6">
                    <div class="card mt-5">
                        <div class="card-body">
                            <div class="row mb-1 text-center">
                                <img src="~/img/announcement.png" style="width:20%; height:20%;" class="d-block mx-auto" />
                            </div>
                            <div class="mb-3 row text-center">
                                <p class="d-block mx-auto">
                                    Mutlaka Okuyun
                                    Gönderdiğiniz tarif ve fotoğraflar kesinlikle size ait olmalı, size ait değilse göndermeyiniz.
                                    Fotoğrafı net olmayan, karanlık veya bulanık olan tarifleriniz yayınlanmayacaktır.
                                    Tariflerinizin yayınlanabilmesi için lütfen fotoğraf çekimlerinize özen gösteriniz.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <script>
        $(document).ready(function () {
            $("#buttonsave").click(function (event) {
                event.preventDefault(); // Formun varsayılan gönderimini engeller

                 // Formun doğrulanıp doğrulanmadığını kontrol et
                    var formData = new FormData($("#foodForm")[0]); // Form verilerini topla

                    $.ajax({
                        type: "POST",
                        url: $('#foodForm').attr('action'),
                        data: formData,
                        processData: false, // FormData ile işlemek için false
                        contentType: false, // İçerik türünü otomatik belirle
                        success: function (response) {
                            alert(response.message); // Başarı mesajı
                        },
                        error: function (response) {
                            alert("Hata oluştu: " + response.responseText); // Hata mesajı
                        }
                    });
                
            });
        });
    </script>
</body>
